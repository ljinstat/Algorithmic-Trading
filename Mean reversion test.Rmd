---
title: "Mean reversion test"
author: "Ling JIN"
date: "22 septembre 2016"
output: html_document
---

```{r, echo = F, message=FALSE}
library('zoo')
library('xts')
library('Quandl')
library('urca')
library('tseries')
```

```{r}
data <- Quandl("GOOG/NASDAQ_GOOGL", start_date="2015-08-19")
data <- data[length(data$Close):1, ]
dataframe<- data.frame(
  Date = data$Date,
  Close = data$Close
)
close  = dataframe$Close
print(head(dataframe))
```

Here is the price tendence :

```{r, echo=FALSE}
heading = "Stock Price of Google from 2015-08-19"
plot(close, type = 'l', col = 'blue', main = heading, xlab = "Date", ylab = "Close Price")
```

Firstly, we use just linear regression to calculate t-test value of the statistics.
```{r}
#time
t = seq(1:(length(close)-2))

#difference of y_t
y.diff = diff(close)

#difference of y_t
y.t.diff = embed(y.diff, 2)[,1]

#y_t-1
y.t1 = close[2:length(y.diff)]

#diference of y_t-1
y.diff.lag = embed(y.diff, 2)[,2]

formula = lm(y.t.diff ~ t + y.t1 + y.diff.lag)
summary(formula)
summary(formula)$coefficients[3,3]
```
$\alpha = 32.86466, \beta = 0.01678, \gamma = -0.04724, \theta = 0.07782, t-test statistics = -2.617431$ 

Now we use a function from the package 'urca'. In this function, we cannot choose both trend and drift.
```{r}
#the object
test.adf = ur.df(close, type = c("trend"), lags = 1)

summary(test.adf)

```
According to the result, the value of t-test statistics is $-2.6174$, not less than critical value at 95% significant level. Thus we cannot reject $H_0$.

And also this function :
```{r}
adf.test(close, k=1)
```
t-test statistics is $-2.6174$, p-value = $0.3159$. Thus we cannot reject $H_0$. This series is not mean reverting.